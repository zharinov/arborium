<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>arborium - Syntax Highlighting Demo</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path fill='%2350C878' d='m7.2 14.2c.8-1 1.6-1.8 2.4-2.4 1.5-1.3 2.8-1.8 2.8-1.8s-.7 1.1-1.8 2.7c-.2.4-.5.8-.8 1.3-.3.4-.5.9-.8 1.4s-.5 1-.8 1.5c-.2.5-.6 1.1-.8 1.6s-.5 1.1-.7 1.6c-.1.2-.2.5-.3.7 3.3 1.9 7.7 1.5 10.4-1.4 5-5.4.6-7.7 5.2-17.2 0 0-10.2-2.1-17.5 5.1-3.3 3.3-3.3 8.6 0 12 .2-.6.4-1.2.7-1.8.5-1.2 1.2-2.4 2-3.3z'/></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Hidden icons for JS use -->
        <div style="display:none">{{ICON:mdi:calendar}}{{ICON:mdi:account}}{{ICON:mdi:wikipedia}}{{ICON:simple-icons:webassembly}}{{ICON:devicon-plain:rust}}{{ICON:mdi:apple}}{{ICON:mdi:linux}}{{ICON:mdi:microsoft-windows}}{{ICON:mdi:check-circle}}{{ICON:mdi:chevron-down}}{{ICON:mdi:shuffle-variant}}{{ICON:mdi:git}}{{ICON:mdi:scale-balance}}</div>

        <div class="page-header">
            <h1>
                <span class="arborium-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em"><path fill="#50C878" d="m7.2 14.2c.8-1 1.6-1.8 2.4-2.4 1.5-1.3 2.8-1.8 2.8-1.8s-.7 1.1-1.8 2.7c-.2.4-.5.8-.8 1.3-.3.4-.5.9-.8 1.4s-.5 1-.8 1.5c-.2.5-.6 1.1-.8 1.6s-.5 1.1-.7 1.6c-.1.2-.2.5-.3.7 3.3 1.9 7.7 1.5 10.4-1.4 5-5.4.6-7.7 5.2-17.2 0 0-10.2-2.1-17.5 5.1-3.3 3.3-3.3 8.6 0 12 .2-.6.4-1.2.7-1.8.5-1.2 1.2-2.4 2-3.3z"/></svg></span>
                arborium
            </h1>
            <span class="tagline" id="tagline"></span>
        </div>

        <div class="main-layout">
            <aside class="about-panel">
                <div class="about-panel-header">arborium</div>
                <p>tree-sitter highlighting</p>
                <p>Native &amp; WASM targets</p>
                <p>Queries included</p>
                <div class="about-panel-links">
                    <a href="https://github.com/bearcove/arborium">github</a>
                    <a href="https://docs.rs/arborium">docs</a>
                    <a href="https://crates.io/crates/arborium">crates.io</a>
                </div>
            </aside>

            <div class="editor-container" id="demo">
                <div class="panel">
                    <div class="editor-toolbar">
                        <div class="toolbar-controls">
                            <div class="lang-picker" id="lang-picker">
                                <div class="lang-picker-label" id="lang-label">
                                    <span class="lang-icon"></span>
                                    <span class="lang-name">Select a language...</span>
                                    <span class="picker-caret">{{ICON:mdi:chevron-down}}</span>
                                </div>
                                <input type="text" class="lang-picker-input" id="lang-input" placeholder="Type to search..." autocomplete="off">
                                <div class="lang-dropdown" id="lang-dropdown"></div>
                            </div>
                            <div class="theme-picker" id="theme-picker">
                                <div class="theme-picker-label" id="theme-label">
                                    <span class="theme-name">Select a theme...</span>
                                    <span class="picker-caret">{{ICON:mdi:chevron-down}}</span>
                                </div>
                                <input type="text" class="theme-picker-input" id="theme-input" placeholder="Type to search..." autocomplete="off">
                                <div class="theme-dropdown" id="theme-dropdown"></div>
                            </div>
                            <div class="mode-toggle" id="mode-toggle">
                                <button class="mode-btn" data-mode="dark" id="mode-dark" title="Dark themes">
                                    <span class="mode-icon">{{ICON:mdi:weather-night}}</span>
                                </button>
                                <button class="mode-btn" data-mode="light" id="mode-light" title="Light themes">
                                    <span class="mode-icon">{{ICON:mdi:weather-sunny}}</span>
                                </button>
                            </div>
                            <button class="random-btn" id="random-btn" title="Random language & theme">
                                {{ICON:mdi:shuffle-variant}} Randomize
                            </button>
                        </div>
                    </div>
                    <div class="editor-scroll">
                        <div class="editor-layers">
                            <div id="output" class="output">
                                <span class="loading">Loading WASM module...</span>
                            </div>
                            <textarea id="source" spellcheck="false"></textarea>
                        </div>
                    </div>
                    <div id="sample-bar" class="sample-bar"></div>
                </div>
            </div>

            <aside id="lang-info-panel" class="lang-info-panel"></aside>
        </div>

        <div id="status" class="status"></div>

        <nav class="section-nav" id="section-nav">
            <a href="#demo" class="nav-link active">Demo</a>
            <a href="#about" class="nav-link">About</a>
            <a href="#get-started" class="nav-link">Get Started</a>
            <a href="#integrations" class="nav-link">Integrations</a>
            <a href="#languages" class="nav-link">Languages</a>
            <a href="#themes" class="nav-link">Themes</a>
            <a href="#faq" class="nav-link">FAQ</a>
        </nav>

        <div class="cards-container">
            <div class="about-card solution" id="about">
                <h3>arborium</h3>
                <p>Finding good tree-sitter grammars is hard. In arborium, every grammar:</p>
                <ul class="check-list">
                    <li>{{ICON:mdi:check-circle}} Is generated with tree-sitter 0.25</li>
                    <li>{{ICON:mdi:check-circle}} Builds for WASM &amp; native via cargo</li>
                    <li>{{ICON:mdi:check-circle}} Has working highlight queries</li>
                </ul>
                <p>
                    We provide any C symbols the scanner might rely on. We patched grammars and wrote
                    highlight queries so you don't have to. Enjoy.
                </p>
            </div>

            <div class="about-card">
                <h3>Output formats</h3>
                <p>
                    <strong>HTML</strong> — custom elements like <code>&lt;a-k&gt;</code> instead of
                    <code>&lt;span class="keyword"&gt;</code>. More compact markup. No JavaScript required.
                </p>
                <div class="compare-boxes">
                    <div class="compare-box old">
                        <span class="compare-label">Traditional</span>
                        <code><a-tg>&lt;span</a-tg> <a-at>class</a-at><a-p>=</a-p><a-s>"keyword"</a-s><a-tg>&gt;</a-tg>fn<a-tg>&lt;/span&gt;</a-tg></code>
                    </div>
                    <div class="compare-box new">
                        <span class="compare-label">arborium</span>
                        <code><a-tg>&lt;a-k&gt;</a-tg><a-k>fn</a-k><a-tg>&lt;/a-k&gt;</a-tg></code>
                    </div>
                </div>
                <p>
                    <strong>ANSI</strong> — 24-bit true color for terminal applications.
                </p>
            </div>

            <div class="about-card">
                <h3>Platforms</h3>
                <div class="platform-section">
                    <div class="platform-group">
                        <div class="platform-logos">
                            <span class="platform-logo" title="macOS">{{ICON:mdi:apple}}</span>
                            <span class="platform-logo" title="Linux">{{ICON:mdi:linux}}</span>
                            <span class="platform-logo" title="Windows">{{ICON:mdi:microsoft-windows}}</span>
                        </div>
                        <p>
                            <strong>macOS, Linux, Windows</strong> — tree-sitter handles generating native crates
                            for these platforms. Just add the dependency and go.
                        </p>
                    </div>
                    <div class="platform-group wasm">
                        <div class="platform-logos">
                            <span class="platform-logo" title="WebAssembly">{{ICON:simple-icons:webassembly}}</span>
                        </div>
                        <p>
                            <strong>WebAssembly</strong> — that one's hard. Compiling Rust to WASM with C code that
                            assumes a standard library is tricky. We provide a sysroot that makes this work,
                            enabling Rust-on-the-frontend scenarios like this demo.
                        </p>
                    </div>
                </div>
            </div>

            <div class="about-card" id="get-started">
                <h3>Get Started</h3>
                <div class="get-started-options">
                    <div class="get-started-option">
                        <h4>Script tag (zero config)</h4>
                        <p>Add this to your HTML and all <code>&lt;pre&gt;&lt;code&gt;</code> blocks get highlighted automatically:</p>
                        <pre class="code-block"><code><a-tg>&lt;script</a-tg> <a-at>src</a-at><a-p>=</a-p><a-s>"https://cdn.jsdelivr.net/npm/@arborium/arborium@{{VERSION}}/dist/arborium.iife.js"</a-s><a-tg>&gt;&lt;/script&gt;</a-tg></code></pre>
                        <p>Your code blocks should look like this:</p>
                        <pre class="code-block"><code><a-tg>&lt;pre&gt;&lt;code</a-tg> <a-at>class</a-at><a-p>=</a-p><a-s>"language-rust"</a-s><a-tg>&gt;</a-tg>fn main() {}<a-tg>&lt;/code&gt;&lt;/pre&gt;</a-tg>
<a-c>&lt;!-- or --&gt;</a-c>
<a-tg>&lt;pre&gt;&lt;code</a-tg> <a-at>data-lang</a-at><a-p>=</a-p><a-s>"rust"</a-s><a-tg>&gt;</a-tg>fn main() {}<a-tg>&lt;/code&gt;&lt;/pre&gt;</a-tg>
<a-c>&lt;!-- or just let it auto-detect --&gt;</a-c>
<a-tg>&lt;pre&gt;&lt;code&gt;</a-tg>fn main() {}<a-tg>&lt;/code&gt;&lt;/pre&gt;</a-tg></code></pre>
                        <p>Configure via data attributes:</p>
                        <pre class="code-block"><code><a-tg>&lt;script</a-tg> <a-at>src</a-at><a-p>=</a-p><a-s>"..."</a-s>
  <a-at>data-theme</a-at><a-p>=</a-p><a-s>"github-light"</a-s>      <a-c>&lt;!-- theme name --&gt;</a-c>
  <a-at>data-selector</a-at><a-p>=</a-p><a-s>"pre code"</a-s>        <a-c>&lt;!-- CSS selector --&gt;</a-c>
  <a-at>data-manual</a-at>                     <a-c>&lt;!-- disable auto-highlight --&gt;</a-c>
  <a-at>data-cdn</a-at><a-p>=</a-p><a-s>"unpkg"</a-s><a-tg>&gt;&lt;/script&gt;</a-tg>       <a-c>&lt;!-- jsdelivr | unpkg | custom URL --&gt;</a-c></code></pre>
                        <p>With <code>data-manual</code>, call <code>window.arborium.highlightAll()</code> when ready.</p>
                        <p><a href="iife-demo.html">See the IIFE demo →</a></p>
                    </div>
                    <div class="get-started-option">
                        <h4>Rust (native or WASM)</h4>
                        <p>Add to your <code>Cargo.toml</code>:</p>
                        <pre class="code-block"><code>arborium = { version = "{{VERSION}}", features = ["lang-rust"] }</code></pre>
                        <p>Then highlight code:</p>
                        <pre class="code-block"><code><a-k>let</a-k> html <a-o>=</a-o> arborium<a-p>::</a-p>highlight(<a-s>"rust"</a-s>, source, <a-o>&amp;</a-o>theme)<a-p>;</a-p></code></pre>
                    </div>
                    <div class="get-started-option">
                        <h4>npm (ESM)</h4>
                        <p>For bundlers or manual control:</p>
                        <pre class="code-block"><code><a-k>import</a-k> { loadGrammar, highlight } <a-k>from</a-k> <a-s>'@arborium/arborium'</a-s><a-p>;</a-p>

<a-k>const</a-k> html <a-o>=</a-o> <a-k>await</a-k> highlight(<a-s>'rust'</a-s>, sourceCode)<a-p>;</a-p></code></pre>
                        <p>Grammars are loaded on-demand from jsdelivr (configurable).</p>
                    </div>
                </div>
            </div>

            <div class="about-card" id="integrations">
                <h3>Integrations</h3>
                <div class="integrations-grid">
                    <div class="integration-item">
                        <h4>{{ICON:mdi:alert-circle-outline}} miette-arborium</h4>
                        <p>Syntax highlighting for <a href="https://crates.io/crates/miette">miette</a> error diagnostics. Beautiful, accurate highlighting in your CLI error messages.</p>
                        <pre class="code-block"><code><a-k>use</a-k> miette<a-p>::</a-p>GraphicalReportHandler<a-p>;</a-p>
<a-k>use</a-k> miette_arborium<a-p>::</a-p>ArboriumHighlighter<a-p>;</a-p>

<a-k>let</a-k> handler <a-o>=</a-o> GraphicalReportHandler<a-p>::</a-p>new()
    <a-p>.</a-p>with_syntax_highlighting(ArboriumHighlighter<a-p>::</a-p>new())<a-p>;</a-p></code></pre>
                        <p class="integration-links">
                            <a href="https://crates.io/crates/miette-arborium">crates.io</a> ·
                            <a href="https://docs.rs/miette-arborium">docs.rs</a>
                        </p>
                    </div>
                    <div class="integration-item">
                        <h4>{{ICON:mdi:palette-outline}} arborium-theme</h4>
                        <p>Theme definitions for arborium. Load themes from TOML files or use one of 13+ built-in themes (Catppuccin, Dracula, Tokyo Night, etc.)</p>
                        <pre class="code-block"><code><a-k>use</a-k> arborium<a-p>::</a-p>theme<a-p>::</a-p>builtin<a-p>;</a-p>

<a-k>let</a-k> theme <a-o>=</a-o> builtin<a-p>::</a-p>dracula()<a-p>;</a-p>
<a-k>let</a-k> html <a-o>=</a-o> arborium<a-p>::</a-p>highlight(<a-s>"rust"</a-s>, code, theme)<a-p>;</a-p></code></pre>
                        <p class="integration-links">
                            <a href="https://crates.io/crates/arborium-theme">crates.io</a> ·
                            <a href="https://docs.rs/arborium-theme">docs.rs</a>
                        </p>
                    </div>
                    <div class="integration-item">
                        <h4>{{ICON:mdi:file-document-outline}} dodeca</h4>
                        <p>A static site generator that uses arborium for syntax highlighting. Markdown to HTML with beautiful code blocks.</p>
                        <p class="integration-links">
                            <a href="https://dodeca.bearcove.eu/">Website</a> ·
                            <a href="https://github.com/bearcove/dodeca">GitHub</a>
                        </p>
                    </div>
                    <div class="integration-item">
                        <h4>{{ICON:mdi:book-open-page-variant}} docs.rs</h4>
                        <p>Highlight TOML, shell, and other languages in your rustdoc. Create <code>arborium-header.html</code>:</p>
                        <pre class="code-block"><code><a-tg>&lt;script</a-tg> <a-at>defer</a-at> <a-at>src</a-at><a-p>=</a-p><a-s>"https://cdn.jsdelivr.net/npm/@arborium/arborium/dist/arborium.iife.js"</a-s><a-tg>&gt;&lt;/script&gt;</a-tg></code></pre>
                        <p>Then in <code>Cargo.toml</code>:</p>
                        <pre class="code-block"><code><a-p>[</a-p><a-v>package.metadata.docs.rs</a-v><a-p>]</a-p>
<a-v>rustdoc-args</a-v> <a-o>=</a-o> <a-p>[</a-p><a-s>"--html-in-header"</a-s><a-p>,</a-p> <a-s>"arborium-header.html"</a-s><a-p>]</a-p></code></pre>
                    </div>
                </div>
            </div>

            <div class="about-card" id="languages">
                <h3>Languages</h3>
                <p>
                    <strong id="lang-count">90+</strong> languages included, each behind a feature flag.
                    Enable only what you need, or use <code>all-languages</code> for everything.
                </p>
                <div class="lang-marquee-container">
                    <div class="lang-marquee" id="lang-marquee"></div>
                </div>
                <p>
                    Each feature flag comment includes the grammar's license, so you always know what
                    you're shipping.
                </p>
            </div>

            <div class="about-card" id="themes">
                <h3>Theme support</h3>
                <p>
                    The highlighter supports themes for both <strong>HTML</strong> and <strong>ANSI</strong> output.
                </p>
                <p class="theme-list-label">Bundled themes:</p>
                <div class="theme-swatches">
                    {{THEME_SWATCHES}}
                </div>
                <p>
                    Custom themes can be defined programmatically using RGB colors and style attributes
                    (bold, italic, underline, strikethrough).
                </p>
            </div>

            <div class="about-card faq" id="faq">
                <h3>FAQ</h3>
                <div class="faq-item">
                    <h4><span class="faq-icon">{{ICON:mdi:regex}}</span>Why not highlight.js or Shiki?</h4>
                    <div class="faq-answer">
                        <p>Those use regex-based tokenization (TextMate grammars). Regexes can't count brackets, track scope, or understand structure—they just pattern-match.</p>
                        <p>Tree-sitter actually <em>parses</em> your code into a syntax tree, so it knows that <code>fn</code> is a keyword only in the right context, handles deeply nested structures correctly, and recovers gracefully from syntax errors.</p>
                        <p>IDEs with LSP support (like rust-analyzer) can do even better with <em>semantic</em> highlighting—they understand types and dependencies across files—but tree-sitter gets you 90% of the way there without needing a full language server.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <h4><span class="faq-icon">{{ICON:mdi:forest}}</span>Why "arborium"?</h4>
                    <div class="faq-answer">
                        <p><em>Arbor</em> is Latin for tree (as in tree-sitter), and <em>-ium</em> denotes a place or collection (like aquarium, arboretum).</p>
                        <p>It's a place where tree-sitter grammars live.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <h4><span class="faq-icon">{{ICON:mdi:plus-circle-outline}}</span>I have a grammar that's not included. Can you add it?</h4>
                    <div class="faq-answer">
                        <p>Yes! <a href="https://github.com/bearcove/arborium/issues">Open an issue</a> on the repo with a link to the grammar.</p>
                        <p>We'll review it and add it if the grammar and highlight queries are in good shape.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <h4><span class="faq-icon">{{ICON:simple-icons:webassembly}}</span>Why not use the WASM builds from tree-sitter CLI?</h4>
                    <div class="faq-answer">
                        <p>When doing full-stack Rust, it's nice to have <em>exactly</em> the same code on the frontend and the backend.</p>
                        <p>Rust crates compile to both native and WASM, so you get one dependency that works everywhere.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <h4><span class="faq-icon">{{ICON:mdi:weight}}</span>Why are tree-sitter parsers so large?</h4>
                    <div class="faq-answer">
                        <p>Tree-sitter uses table-driven LR parsing. The grammar compiles down to massive state transition tables—every possible parser state and every possible token gets an entry.</p>
                        <p>These tables are optimized for O(1) lookup speed, not size. A complex grammar like TypeScript can have tens of thousands of states.</p>
                        <p>The tradeoff is worth it: you get real parsing (not regex hacks) that handles edge cases correctly and recovers gracefully from syntax errors.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <h4><span class="faq-icon">{{ICON:mdi:language-html5}}</span>Can I use this without Rust / just embed it on my website?</h4>
                    <div class="faq-answer">
                        <p>Yes! Use our npm package <code>@arborium/arborium</code>. It provides both an ESM module and an IIFE bundle that auto-highlights code blocks on your page.</p>
                        <p>The IIFE bundle exposes <code>window.arborium</code> with methods like <code>highlightAll()</code>, <code>highlightElement(el, lang)</code>, and <code>detectLanguage(source)</code>.</p>
                        <p>See the "Get Started" section above for details.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <h4><span class="faq-icon">{{ICON:mdi:cloud-download-outline}}</span>Could a ready-to-embed kit load grammars on-demand?</h4>
                    <div class="faq-answer">
                        <p>Yes! That's what the IIFE bundle does. It detects languages in your code blocks and fetches grammars from jsdelivr as needed.</p>
                    </div>
                </div>
            </div>

        </div>

        <footer>
            <span class="footer-credit"><a href="https://github.com/bearcove/arborium">arborium</a> by <a href="https://fasterthanli.me/">fasterthanlime</a></span>
            <span class="footer-sep">·</span>
            <span class="footer-credit"><a href="https://tree-sitter.github.io/">tree-sitter</a> by <a href="https://github.com/maxbrunsfeld">Max Brunsfeld</a></span>
            <span class="footer-sep">·</span>
            <span class="footer-font">code font <a href="https://typeof.net/Iosevka/">Iosevka</a></span>
        </footer>
    </div>

    <script type="module" src="pkg/app.generated.js"></script>
    <script>
        // Section navigation - highlight active section on scroll
        (function() {
            const nav = document.getElementById('section-nav');
            const links = nav.querySelectorAll('.nav-link');
            const sections = [];

            links.forEach(link => {
                const id = link.getAttribute('href').slice(1);
                const section = document.getElementById(id);
                if (section) sections.push({ id, el: section, link });
            });

            function updateActiveLink() {
                const scrollPos = window.scrollY + 100;

                let activeSection = sections[0];
                for (const section of sections) {
                    if (section.el.offsetTop <= scrollPos) {
                        activeSection = section;
                    }
                }

                links.forEach(link => link.classList.remove('active'));
                if (activeSection) {
                    activeSection.link.classList.add('active');
                }
            }

            window.addEventListener('scroll', updateActiveLink, { passive: true });
            updateActiveLink();

            // Smooth scroll for nav links
            links.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const id = link.getAttribute('href').slice(1);
                    const target = document.getElementById(id);
                    if (target) {
                        const offset = nav.offsetHeight + 20;
                        window.scrollTo({
                            top: target.offsetTop - offset,
                            behavior: 'smooth'
                        });
                    }
                });
            });
        })();
    </script>
</body>
</html>
